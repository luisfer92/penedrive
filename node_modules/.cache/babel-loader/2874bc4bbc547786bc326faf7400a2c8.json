{"ast":null,"code":"import _objectSpread from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect}from'react';import{database}from'../firebase';import{useAuth}from'./AuthContext';import{CompisProvider}from'./CompisContext';import{MaquinariaProvider}from'./MaquinariaContext';import{MessageProvider}from'./MessageContext';import{TecnicosProvider}from'./TenicosContext';import{TrabajadorProvider}from'./TrabajadorContext';import{jsx as _jsx}from\"react/jsx-runtime\";var LocalContext=/*#__PURE__*/React.createContext();export function useLocal(){return React.useContext(LocalContext);}export function LocalProvider(_ref){var children=_ref.children;var _useAuth=useAuth(),userAPI=_useAuth.userAPI;var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),locales=_React$useState2[0],setLocales=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),local=_React$useState4[0],setLocal=_React$useState4[1];var _React$useState5=React.useState(),_React$useState6=_slicedToArray(_React$useState5,2),categorias=_React$useState6[0],setCategorias=_React$useState6[1];var value={local:local,locales:locales,abandonarLocal:function abandonarLocal(){setLocal(null);},setLocal:setLocal,setLocales:setLocales};useEffect(function(){var unsubscribre=null;if(local){unsubscribre=database.collection('locales').doc(local.id).onSnapshot(function(snap){setLocal(_objectSpread({id:snap.id},snap.data()));});}return unsubscribre?function(){return unsubscribre();}:null;},[setLocal]);useEffect(function(){if(userAPI){var load=[];database.collection(\"locales\").where('allowed_users','array-contains',userAPI.correo).get().then(function(query){query.forEach(function(doc){load.push(_objectSpread({id:doc.id},doc.data()));});var size=load.length;console.log(size);setLocales(load);size==1&&setLocal(load[0]);});}},[userAPI]);return/*#__PURE__*/_jsx(LocalContext.Provider,{value:value,children:/*#__PURE__*/_jsx(TecnicosProvider,{children:/*#__PURE__*/_jsx(MaquinariaProvider,{children:/*#__PURE__*/_jsx(CompisProvider,{children:/*#__PURE__*/_jsx(TrabajadorProvider,{children:/*#__PURE__*/_jsx(MessageProvider,{children:children})})})})})});}","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/contexts/LocalContext.js"],"names":["React","useEffect","database","useAuth","CompisProvider","MaquinariaProvider","MessageProvider","TecnicosProvider","TrabajadorProvider","LocalContext","createContext","useLocal","useContext","LocalProvider","children","userAPI","useState","locales","setLocales","local","setLocal","categorias","setCategorias","value","abandonarLocal","unsubscribre","collection","doc","id","onSnapshot","snap","data","load","where","correo","get","then","query","forEach","push","size","length","console","log"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { database } from '../firebase'\nimport { useAuth } from './AuthContext';\nimport { CompisProvider } from './CompisContext';\nimport { MaquinariaProvider } from './MaquinariaContext';\nimport { MessageProvider } from './MessageContext'\nimport { TecnicosProvider } from './TenicosContext';\nimport { TrabajadorProvider } from './TrabajadorContext';\n\nconst LocalContext = React.createContext();\n\n\n\nexport function useLocal() {\n    return React.useContext(LocalContext)\n}\n\n\nexport function LocalProvider({ children }) {\n\n    const { userAPI } = useAuth()\n    const [locales, setLocales] = React.useState()\n    const [local, setLocal] = React.useState(null);\n    const [categorias, setCategorias] = React.useState();\n\n    const value = {\n        local,\n        locales,\n        abandonarLocal: () => { setLocal(null) },\n        setLocal,\n        setLocales\n    }\n\n    useEffect(() => {\n        let unsubscribre = null\n        if (local) {\n            unsubscribre = database.\n                collection('locales').\n                doc(local.id).\n                onSnapshot(\n                    snap => {\n                        setLocal({ id: snap.id, ...snap.data() })\n                    }\n                )\n        }\n        return unsubscribre ? () => unsubscribre() : null\n    }, [setLocal])\n\n\n    useEffect(() => {\n        if (userAPI) {\n\n            const load = []\n            database.collection(\"locales\").\n                where('allowed_users', 'array-contains', userAPI.correo).\n                get().then((query) => {\n                    query.forEach(doc => {\n                        load.push({ id: doc.id, ...doc.data() })\n                    })\n                    const size = load.length\n                    console.log(size)\n                    setLocales(load)\n                    size == 1 && setLocal(load[0])\n                })\n\n        }\n    }, [userAPI])\n\n\n    return (\n        <LocalContext.Provider value={value}>\n            <TecnicosProvider>\n\n                <MaquinariaProvider>\n\n                    <CompisProvider>\n\n                        <TrabajadorProvider>\n\n                            <MessageProvider>\n                                {children}\n                            </MessageProvider>\n\n                        </TrabajadorProvider>\n\n                    </CompisProvider>\n                    \n                </MaquinariaProvider>\n\n            </TecnicosProvider>\n\n\n\n\n        </LocalContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}