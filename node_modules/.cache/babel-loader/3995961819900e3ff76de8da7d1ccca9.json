{"ast":null,"code":"import _toConsumableArray from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Container,Row,Button,Modal,Col}from'react-bootstrap';import{useProducto}from'../../contexts/ProductoContext';import ProductoCategoria from'../common/productoCategoria';import firebase from'firebase/app';import'firebase/firestore';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function(props){var show=props.show,setShow=props.setShow,categoria=props.categoria;var _useProducto=useProducto(),productos=_useProducto.productos,upgradeProductoBulk=_useProducto.upgradeProductoBulk;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),agregados=_useState2[0],setAgregados=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),eliminados=_useState4[0],setEliminados=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),upload=_useState6[0],setUpload=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),huerfanos=_useState8[0],setHuerfanos=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),propios=_useState10[0],setPropios=_useState10[1];useEffect(function(){if(show&&productos){console.log(\"cambiando huerfanos\");var h=productos?productos.filter(function(p){return p.categoria_id==undefined;}):[];var p=productos&&categoria?productos.filter(function(p){return p.categoria_id===categoria.id;}):[];setHuerfanos(h);setPropios(p);}else{setHuerfanos([]);setPropios([]);}setAgregados([]);setEliminados([]);},[show,upload]);var handleAgregar=function handleAgregar(productoId,operation){console.log(operation+\" a categoria \");operation==\"+\"&&setAgregados([].concat(_toConsumableArray(agregados),[productoId]));operation==\"-\"&&setAgregados(agregados.filter(function(id){return id===productoId;}));};var handleEliminar=function handleEliminar(productoId,operation){operation==\"+\"&&setEliminados([].concat(_toConsumableArray(agregados),[productoId]));operation==\"-\"&&setEliminados(agregados.filter(function(id){return id===productoId;}));};var handleModificar=function handleModificar(){upgradeProductoBulk(agregados,{categoria_id:categoria.id});upgradeProductoBulk(eliminados,{categoria_id:firebase.firestore.FieldValue.delete()},true);setUpload(true);};console.log(agregados);return/*#__PURE__*/_jsxs(Modal,{show:show,fullscreen:true,onHide:function onHide(){return setShow(false);},children:[/*#__PURE__*/_jsx(Modal.Header,{className:\"bg-oscuro text-white\",closeVariant:\"white\",closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{className:\"text-white\",children:categoria&&categoria.nombre})}),/*#__PURE__*/_jsxs(Modal.Body,{className:\"bg-claro position-relative\",children:[/*#__PURE__*/_jsx(Row,{className:\"d-flex justify-content-center pb-5\",children:/*#__PURE__*/_jsx(Col,{xs:12,md:11,children:/*#__PURE__*/_jsxs(Row,{className:\"d-flex justify-content-around \",children:[propios.map(function(producto){return/*#__PURE__*/_jsx(ProductoCategoria,{id:producto.id,producto:producto,propio:true,agregar:handleEliminar,eliminar:handleEliminar});}),huerfanos.map(function(producto){return/*#__PURE__*/_jsx(ProductoCategoria,{id:producto.id,producto:producto,agregar:handleAgregar,eliminar:handleAgregar});})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\" w-100 fixed-bottom \",children:/*#__PURE__*/_jsx(Row,{className:\"d-flex justify-content-around bg-oscuro py-2\",children:/*#__PURE__*/_jsx(Col,{xs:12,md:9,lg:2,xl:3,children:/*#__PURE__*/_jsx(Button,{variant:\"success w-100 \",onClick:handleModificar,children:\" Guardar \"})})})})]})]});}","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/components/superAdmin/OrganizadorProductos.js"],"names":["React","useEffect","useState","Container","Row","Button","Modal","Col","useProducto","ProductoCategoria","firebase","props","show","setShow","categoria","productos","upgradeProductoBulk","agregados","setAgregados","eliminados","setEliminados","upload","setUpload","huerfanos","setHuerfanos","propios","setPropios","console","log","h","filter","p","categoria_id","undefined","id","handleAgregar","productoId","operation","handleEliminar","handleModificar","firestore","FieldValue","delete","nombre","map","producto"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { Container, Row, Button, Modal, Col } from 'react-bootstrap'\nimport { useProducto } from '../../contexts/ProductoContext'\nimport ProductoCategoria from '../common/productoCategoria';\n\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\n\nexport default function (props) {\n    const { show, setShow, categoria } = props\n\n    const { productos, upgradeProductoBulk } = useProducto()\n\n    const [agregados, setAgregados] = useState([])\n    const [eliminados, setEliminados] = useState([])\n    const [upload, setUpload] = useState(false)\n\n\n\n\n    const [huerfanos, setHuerfanos] = useState([])\n    \n    const [propios, setPropios] = useState([])\n\n    useEffect(() => {\n        if (show && productos) {\n            console.log(\"cambiando huerfanos\")\n            const h = productos ? productos.filter((p) => p.categoria_id == undefined) : []\n            const p = (productos && categoria) ? productos.filter(p => p.categoria_id === categoria.id) : []\n            setHuerfanos(h)\n            setPropios(p)\n            \n        }else{\n            setHuerfanos([])\n            setPropios([])\n           \n        }\n        setAgregados([])\n        setEliminados([]) \n\n    }, [show, upload])\n\n\n\n    const handleAgregar = (productoId, operation) => {\n        console.log(operation + \" a categoria \")\n        \n        operation == \"+\" && setAgregados([...agregados,productoId])\n        operation == \"-\" && setAgregados(agregados.filter(id => id === productoId))\n       \n    }\n\n    const handleEliminar = (productoId, operation) => {\n        operation == \"+\" && setEliminados([...agregados, productoId])\n        operation == \"-\" && setEliminados(agregados.filter(id => id === productoId))\n    }\n\n\n    const handleModificar = () => {\n\n        upgradeProductoBulk(agregados, { categoria_id: categoria.id })\n        upgradeProductoBulk(eliminados, { categoria_id: firebase.firestore.FieldValue.delete() }, true)\n        \n        setUpload(true)\n    }\n\n    console.log(agregados)\n    return (\n        <Modal show={show} fullscreen={true} onHide={() => setShow(false)}>\n            <Modal.Header className=\"bg-oscuro text-white\" closeVariant=\"white\" closeButton>\n                <Modal.Title className=\"text-white\">{categoria && categoria.nombre}</Modal.Title>\n            </Modal.Header>\n            <Modal.Body className=\"bg-claro position-relative\">\n                <Row className=\"d-flex justify-content-center pb-5\">\n\n                    <Col xs={12} md={11}>\n                        <Row className=\"d-flex justify-content-around \">\n\n\n                            {propios.map((producto) => {\n                                return (\n                                    <ProductoCategoria id={producto.id} producto={producto} propio={true} agregar={handleEliminar} eliminar={handleEliminar} />\n                                )\n                            })}\n                            {huerfanos.map((producto) => {\n\n                                return (\n                                    <ProductoCategoria id={producto.id} producto={producto} agregar={handleAgregar} eliminar={handleAgregar} />\n                                )\n                            })}\n\n                        </Row>\n\n\n\n                    </Col>\n\n                </Row>\n                <div className=\" w-100 fixed-bottom \">\n                    <Row className=\"d-flex justify-content-around bg-oscuro py-2\">\n                        <Col xs={12} md={9} lg={2} xl={3}>\n                            <Button variant=\"success w-100 \" onClick={handleModificar}> Guardar </Button>\n                        </Col>\n                    </Row>\n\n                </div>\n\n            </Modal.Body>\n        </Modal>\n    )\n}"]},"metadata":{},"sourceType":"module"}