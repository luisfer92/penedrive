{"ast":null,"code":"var _jsxFileName = \"/home/luisfer/Escritorio/rerovaji-control/src/contexts/LocalContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport { database } from '../firebase';\nimport { useAuth } from './AuthContext';\nimport { CompisProvider } from './CompisContext';\nimport { MaquinariaProvider } from './MaquinariaContext';\nimport { MessageProvider } from './MessageContext';\nimport { TecnicosProvider } from './TenicosContext';\nimport { TrabajadorProvider } from './TrabajadorContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LocalContext = /*#__PURE__*/React.createContext();\nexport function useLocal() {\n  _s();\n\n  return React.useContext(LocalContext);\n}\n\n_s(useLocal, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function LocalProvider({\n  children\n}) {\n  _s2();\n\n  const {\n    userAPI\n  } = useAuth();\n  const [locales, setLocales] = React.useState();\n  const [local, setLocal] = React.useState(null);\n  const [categorias, setCategorias] = React.useState();\n  const value = {\n    local,\n    locales,\n    abandonarLocal: () => {\n      setLocal(null);\n    },\n    setLocal,\n    setLocales\n  };\n  useEffect(() => {\n    let unsubscribre = null;\n\n    if (local) {\n      unsubscribre = database.collection('locales').doc(local.id).onSnapshot(snap => {\n        const newLocal = {\n          id: snap.id,\n          ...snap.data()\n        };\n        setLocal(newLocal);\n        window.localStorage.setItem('rerovaji_local', JSON.stringify(newLocal));\n      });\n    } else {\n      const newLocal = window.localStorage.getItem('rerovaji_local');\n      console.log(\"local guardado en localstorage\");\n      newLocal && setLocal(JSON.parse(newLocal));\n    }\n\n    return unsubscribre ? () => unsubscribre() : null;\n  }, [setLocal]);\n  useEffect(() => {\n    if (userAPI) {\n      const load = [];\n      database.collection(\"locales\").where('allowed_users', 'array-contains', userAPI.correo).get().then(query => {\n        query.forEach(doc => {\n          load.push({\n            id: doc.id,\n            ...doc.data()\n          });\n        });\n        const size = load.length;\n        console.log(size);\n        setLocales(load);\n        size == 1 && setLocal(load[0]);\n      });\n    }\n  }, [userAPI]);\n\n  const addCompi = correo => {\n    database.collection(\"locales\").doc(local.id).set(Object.assign);\n  };\n\n  return /*#__PURE__*/_jsxDEV(LocalContext.Provider, {\n    value: value,\n    children: /*#__PURE__*/_jsxDEV(TecnicosProvider, {\n      children: /*#__PURE__*/_jsxDEV(MaquinariaProvider, {\n        children: /*#__PURE__*/_jsxDEV(CompisProvider, {\n          children: /*#__PURE__*/_jsxDEV(TrabajadorProvider, {\n            children: /*#__PURE__*/_jsxDEV(MessageProvider, {\n              children: children\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(LocalProvider, \"3wHKnstYCY6UYXbIIJkhRz0BVMg=\", false, function () {\n  return [useAuth];\n});\n\n_c = LocalProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"LocalProvider\");","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/contexts/LocalContext.js"],"names":["React","useEffect","database","useAuth","CompisProvider","MaquinariaProvider","MessageProvider","TecnicosProvider","TrabajadorProvider","LocalContext","createContext","useLocal","useContext","LocalProvider","children","userAPI","locales","setLocales","useState","local","setLocal","categorias","setCategorias","value","abandonarLocal","unsubscribre","collection","doc","id","onSnapshot","snap","newLocal","data","window","localStorage","setItem","JSON","stringify","getItem","console","log","parse","load","where","correo","get","then","query","forEach","push","size","length","addCompi","set","Object","assign"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { database } from '../firebase'\nimport { useAuth } from './AuthContext';\nimport { CompisProvider } from './CompisContext';\nimport { MaquinariaProvider } from './MaquinariaContext';\nimport { MessageProvider } from './MessageContext'\nimport { TecnicosProvider } from './TenicosContext';\nimport { TrabajadorProvider } from './TrabajadorContext';\n\nconst LocalContext = React.createContext();\n\n\n\nexport function useLocal() {\n    return React.useContext(LocalContext)\n}\n\n\nexport function LocalProvider({ children }) {\n\n    const { userAPI } = useAuth()\n    const [locales, setLocales] = React.useState()\n    const [local, setLocal] = React.useState(null);\n    const [categorias, setCategorias] = React.useState();\n\n    const value = {\n        local,\n        locales,\n        abandonarLocal: () => { setLocal(null) },\n        setLocal,\n        setLocales\n    }\n\n    useEffect(() => {\n        let unsubscribre = null\n        if (local) {\n            unsubscribre = database.\n                collection('locales').\n                doc(local.id).\n                onSnapshot(\n                    snap => {\n                        const newLocal={ id: snap.id, ...snap.data() }\n                        setLocal(newLocal)\n                        window.localStorage.setItem('rerovaji_local',JSON.stringify(newLocal))\n                    }\n                )\n        }else{\n            const newLocal=window.localStorage.getItem('rerovaji_local')\n            console.log(\"local guardado en localstorage\")\n            newLocal && setLocal(JSON.parse(newLocal))\n        }\n        return unsubscribre ? () => unsubscribre() : null\n    }, [setLocal])\n\n\n    useEffect(() => {\n        if (userAPI) {\n\n            const load = []\n            database.collection(\"locales\").\n                where('allowed_users', 'array-contains', userAPI.correo).\n                get().then((query) => {\n                    query.forEach(doc => {\n                        load.push({ id: doc.id, ...doc.data() })\n\n                    })\n                    const size = load.length\n                    console.log(size)\n                    setLocales(load)\n                    size == 1 && setLocal(load[0])\n                })\n\n        }\n    }, [userAPI])\n\n\n    const addCompi = (correo) => {\n        database.collection(\"locales\").doc(local.id).set(Object.assign)\n    }\n\n    return (\n        <LocalContext.Provider value={value}>\n            <TecnicosProvider>\n\n                <MaquinariaProvider>\n\n                    <CompisProvider>\n\n                        <TrabajadorProvider>\n\n                            <MessageProvider>\n                                {children}\n                            </MessageProvider>\n\n                        </TrabajadorProvider>\n\n                    </CompisProvider>\n\n                </MaquinariaProvider>\n\n            </TecnicosProvider>\n\n\n\n\n        </LocalContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}