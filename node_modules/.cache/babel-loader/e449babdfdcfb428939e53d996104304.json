{"ast":null,"code":"var _jsxFileName = \"/home/luisfer/Escritorio/rerovaji-control/src/contexts/ContratoContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { database } from '../firebase';\nimport firebase from \"firebase/app\";\nimport { useLocal } from './LocalContext';\nimport { useTrabajador } from './TrabajadorContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ContratoContext = /*#__PURE__*/React.createContext();\nexport function useContrato() {\n  _s();\n\n  return React.useContext(ContratoContext);\n}\n\n_s(useContrato, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function ContratoProvider({\n  children\n}) {\n  _s2();\n\n  const {\n    local\n  } = useLocal();\n  const [contrato, setContrato] = useState();\n  const [contratos, setContratos] = useState();\n  const [selfDB, setDB] = useState();\n  useEffect(() => {\n    if (local) {\n      const db = database.collection(\"locales\").doc(local.id).collection(\"contratos\");\n      setDB(db);\n    }\n  }, [local]);\n  useEffect(() => {\n    const contracts = [];\n    selfDB === null || selfDB === void 0 ? void 0 : selfDB.get().then(q => {\n      q.forEach(c => contracts.push({\n        id: c.id,\n        ...c.data()\n      }));\n      setContratos(contracts);\n    });\n  }, [selfDB]);\n\n  const getContratoByTrabajadorID = trabajadorID => {\n    return contratos === null || contratos === void 0 ? void 0 : contratos.find(c => c.trabajador_id == trabajadorID);\n  };\n\n  const createContrato = (data, trabajador_id) => {\n    var dataLimpia = data;\n    const {\n      inicio,\n      duracion\n    } = data;\n    dataLimpia.inicio = firebase.firestore.Timestamp.fromMillis(Date.parse(inicio));\n    dataLimpia.duracion = dataLimpia.fin != undefined ? firebase.firestore.Timestamp.fromMillis(Date.parse(duracion)) : firebase.firestore.Timestamp.fromMillis(0);\n\n    if (!trabajador_id) {\n      delete dataLimpia.trabajador_id;\n    } else {\n      dataLimpia.trabajador_id = trabajador_id;\n    }\n\n    console.log(dataLimpia);\n    selfDB.add(data).then(query => {\n      console.log(\"contrato subido\");\n    });\n  };\n\n  const value = {\n    contrato,\n    contratos,\n    createContrato,\n    getContratoByTrabajadorID\n  };\n  return /*#__PURE__*/_jsxDEV(ContratoContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(ContratoProvider, \"aACc7bkuy6/hVLyv3irDqipm1Lg=\", false, function () {\n  return [useLocal];\n});\n\n_c = ContratoProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContratoProvider\");","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/contexts/ContratoContext.js"],"names":["React","useEffect","useState","database","firebase","useLocal","useTrabajador","ContratoContext","createContext","useContrato","useContext","ContratoProvider","children","local","contrato","setContrato","contratos","setContratos","selfDB","setDB","db","collection","doc","id","contracts","get","then","q","forEach","c","push","data","getContratoByTrabajadorID","trabajadorID","find","trabajador_id","createContrato","dataLimpia","inicio","duracion","firestore","Timestamp","fromMillis","Date","parse","fin","undefined","console","log","add","query","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { database } from '../firebase'\nimport firebase from \"firebase/app\";\nimport { useLocal } from './LocalContext';\nimport { useTrabajador } from './TrabajadorContext';\n\n\n\n\nexport const ContratoContext = React.createContext();\n\n\n\n\nexport function useContrato() {\n    return React.useContext(ContratoContext)\n}\nexport function ContratoProvider({ children }) {\n\n    const { local } = useLocal()\n    const [contrato, setContrato] = useState()\n    const [contratos, setContratos] = useState()\n    const [selfDB, setDB] = useState()\n\n\n\n    useEffect(() => {\n\n        if (local) {\n            const db = database.collection(\"locales\").doc(local.id).collection(\"contratos\")\n            setDB(db)\n\n        }\n\n\n    }, [local])\n\n    useEffect(() => {\n        \n\n            const contracts = []\n            selfDB?.get().then(q => {\n\n                q.forEach(c => contracts.push({ id: c.id, ...c.data() }))\n                setContratos(contracts)\n            })\n        \n\n    }, [selfDB])\n\n\n    const getContratoByTrabajadorID = (trabajadorID) => {\n        return contratos?.find(c => c.trabajador_id == trabajadorID)\n    }\n\n\n    const createContrato = (data, trabajador_id) => {\n        var dataLimpia = data\n        const { inicio, duracion } = data\n        dataLimpia.inicio = firebase.firestore.Timestamp.fromMillis(Date.parse(inicio))\n        dataLimpia.duracion = dataLimpia.fin != undefined ? firebase.firestore.Timestamp.fromMillis(Date.parse(duracion)) : firebase.firestore.Timestamp.fromMillis(0)\n        if (!trabajador_id) {\n            delete dataLimpia.trabajador_id\n        } else {\n            dataLimpia.trabajador_id = trabajador_id\n        }\n        console.log(dataLimpia)\n\n        selfDB.add(data).then((query) => {\n            console.log(\"contrato subido\")\n        })\n\n    }\n\n    const value = {\n        contrato,\n        contratos,\n        createContrato,\n        getContratoByTrabajadorID,\n\n    }\n\n\n    return (\n        <ContratoContext.Provider value={value}>\n            {children}\n        </ContratoContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}