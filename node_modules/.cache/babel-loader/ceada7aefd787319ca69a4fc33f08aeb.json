{"ast":null,"code":"var _jsxFileName = \"/home/luisfer/Escritorio/rerovaji-control/src/components/superAdmin/ProductoEditor.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport MainHolder from '../common/MainHolder';\nimport { Link, useParams } from \"react-router-dom\";\nimport { useProducto } from '../../contexts/ProductoContext';\nimport { Col, Form, Row, InputGroup, Spinner } from 'react-bootstrap';\nimport { FaAdjust, FaEuroSign, FaBox, FaFingerprint, FaLock, FaShareAlt, FaThumbsUp, FaAngleRight, FaAngleLeft } from 'react-icons/fa';\nimport Producto from './ProductoClasificable';\nimport SecondaryHolder from '../common/SecondaryHolder';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst FormItem = props => {\n  _s();\n\n  const {\n    nombre,\n    value,\n    holder,\n    lock = false,\n    cambios,\n    handleChange,\n    saved\n  } = props;\n  const [initial, setInitial] = useState(value);\n  const [autosave, setAutosave] = useState(null);\n  const saving = cambios && Object.keys(cambios).includes(nombre.toLowerCase()) && autosave;\n\n  const setValue = event => {\n    const val = event.target.value.trim().toLowerCase();\n    var newCambio = {};\n\n    if (initial !== val) {\n      newCambio[nombre.toLowerCase()] = val;\n      const newChanges = Object.assign({}, cambios, newCambio);\n      setInitial(val);\n      handleChange(newChanges);\n    } else {}\n  };\n\n  const handleItemChange = event => {\n    console.log(initial);\n    const val = event.target.value;\n\n    if (val !== \"\" && initial !== val) {\n      if (autosave) {\n        console.log(\"sigues escribiendo\");\n        clearTimeout(autosave);\n        setAutosave(setTimeout(() => {\n          setValue(event);\n        }, 2000));\n      } else {\n        console.log(\"has empezado a escribir\");\n        setAutosave(setTimeout(() => {\n          setValue(event);\n        }, 2000));\n      }\n    } else {\n      console.log(\"los valores de inicio y actual coinciden\");\n      clearTimeout(autosave);\n      setAutosave(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form.Group, {\n    className: \"mb-2\",\n    as: Col,\n    xs: 12,\n    children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n      children: nombre\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(InputGroup, {\n      className: \"mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n        placeholder: value ? value : holder,\n        readOnly: lock,\n        onChange: handleItemChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }, this), lock && /*#__PURE__*/_jsxDEV(InputGroup.Text, {\n        className: \"text-warning fs-1 bg-transparent\",\n        children: /*#__PURE__*/_jsxDEV(FaLock, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 88\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 26\n      }, this), saving && !saved && /*#__PURE__*/_jsxDEV(InputGroup.Text, {\n        className: \"text-warning fs-1 bg-transparent\",\n        children: /*#__PURE__*/_jsxDEV(Spinner, {\n          animation: \"grow\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 102\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 40\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n};\n\n_s(FormItem, \"4PDKcnjUH5fgKPgKDXmHgla6tUs=\");\n\n_c = FormItem;\n\nconst CategoriaEdicion = props => {\n  _s2();\n\n  const {\n    children,\n    nombre,\n    icono\n  } = props;\n  const [active, setActive] = useState(false);\n  return /*#__PURE__*/_jsxDEV(Col, {\n    sm: 12,\n    lg: 12,\n    xl: 6,\n    className: `${active ? \"border\" : \"border-top\"} border-white border-3 rounded rounded-2 px-2 mb-sm-2 h-auto my-2`,\n    children: [/*#__PURE__*/_jsxDEV(Col, {\n      xs: 12,\n      className: `${!active ? \"border border-3\" : \"border-bottom\"} border-white fs-3 d-flex py-auto justify-content-center  text-white`,\n      onClick: () => setActive(!active),\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"me-2 text-capitalize\",\n        children: nombre\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: icono\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Col, {\n      xs: 12,\n      className: \"px-2\",\n      children: active && children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(CategoriaEdicion, \"1cfVChV6gA1Fk8+xDnwTj3gmgZo=\");\n\n_c2 = CategoriaEdicion;\n\nconst Categoria = props => {\n  const {\n    nombre,\n    id\n  } = props;\n  return /*#__PURE__*/_jsxDEV(\"option\", {\n    value: id,\n    children: nombre\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 12\n  }, this);\n};\n\n_c3 = Categoria;\n\nconst Editor = props => {\n  _s3();\n\n  const {\n    id\n  } = useParams();\n  const {\n    productos,\n    categorias,\n    upgradeProducto\n  } = useProducto();\n  const [current, setCurrent] = useState({});\n  const [cambios, setCambios] = useState(null);\n  const [autosave, setAutosave] = useState(null);\n  const [saved, setSaved] = useState(false);\n  useEffect(() => {\n    productos && setCurrent(productos.find(p => p.id == id));\n  }, [productos]);\n  useEffect(() => {\n    cambios && upgradeProducto(id, cambios);\n  }, [cambios]);\n\n  const getCategoria = catId => {\n    const categoria = categorias.find(c => c.id === catId);\n    return categoria;\n  };\n\n  const save = cambios => {\n    console.log(\"Guardando los cambios en firebase\");\n    setCambios(cambios);\n    setSaved(true);\n  };\n\n  const handleSave = cambios => {\n    console.log(\"cambio requrido\");\n    console.log(cambios);\n    setSaved(false);\n\n    if (autosave) {\n      console.log(\"sigues modificando el formulario\");\n      window.clearTimeout(autosave);\n      setAutosave(window.setTimeout(() => {\n        save(cambios);\n      }, 5000));\n    } else {\n      console.log(\"has modificado el formulario\");\n      setAutosave(window.setTimeout(() => {\n        save(cambios);\n      }, 5000));\n    }\n  };\n\n  const handleDropdowns = event => {\n    const {\n      value,\n      id\n    } = event.target;\n    console.log(id);\n\n    if (id === \"categorias\") {\n      handleSave(Object.assign({}, cambios, {\n        categoria_id: value\n      }));\n    }\n\n    if (id === \"iva\") {\n      handleSave(Object.assign({}, cambios, {\n        iva: value\n      }));\n    }\n  };\n\n  const {\n    nombre,\n    precio,\n    unidades,\n    paquetes,\n    peso,\n    iva,\n    categoria_id\n  } = current;\n  const {\n    codigo_barras,\n    codisis_id\n  } = current;\n  const categoria = categoria_id && getCategoria(categoria_id);\n  return /*#__PURE__*/_jsxDEV(SecondaryHolder, {\n    title: \"Editar - \" + nombre,\n    back: \"/productos\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"justify-content-center justify-content-lg-around mx-auto w-100 align-items-center pt-2\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        xs: 12,\n        md: 8,\n        lg: 4,\n        xl: 3,\n        className: \"d-flex  justify-content-center align-items-center \",\n        children: productos && /*#__PURE__*/_jsxDEV(Producto, { ...current,\n          editable: true,\n          expand: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 35\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 12,\n        lg: 7,\n        xl: 8,\n        className: \" text-white py-2 px-0\",\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          as: Row,\n          className: \"bg-oscuro justify-content-around\",\n          children: [/*#__PURE__*/_jsxDEV(FormItem, {\n            nombre: \"Nombre\",\n            value: nombre,\n            holder: \"Nombre del producto\",\n            handleChange: handleSave,\n            cambios: cambios,\n            saved: saved\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \"mb-2\",\n            as: Col,\n            xs: 12,\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Categoria\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n              id: \"categorias\",\n              onChange: handleDropdowns,\n              children: [categoria ? /*#__PURE__*/_jsxDEV(Categoria, { ...categoria\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 46\n              }, this) : /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \" Categoria del producto \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 77\n              }, this), categorias && categorias.map(c => c.id !== categoria_id ? /*#__PURE__*/_jsxDEV(Categoria, { ...c\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 92\n              }, this) : null)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(CategoriaEdicion, {\n            nombre: \"exclusivo\",\n            children: /*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-2 ps-3 ps-md-0 d-sm-flex d-lg-block justify-content-center pt-2 bg-info\",\n              as: Col,\n              xs: 12,\n              children: [/*#__PURE__*/_jsxDEV(Form.Check, {\n                inline: true,\n                label: \"No\",\n                name: \"no_exclusivo\",\n                type: \"checkbox\",\n                id: \"no\",\n                className: \"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                inline: true,\n                label: \"Andalucia\",\n                name: \"andalucia\",\n                type: \"checkbox\",\n                id: \"andalucia\",\n                className: \"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                inline: true,\n                label: \"Levante\",\n                name: \"levante\",\n                type: \"checkbox\",\n                id: \"levante\",\n                className: \"w-100 w-md-auto  my-2 my-md-auto w-lg-100 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                inline: true,\n                label: \"Canarias\",\n                name: \"canarias\",\n                type: \"checkbox\",\n                id: \"canarias\",\n                className: \"w-100 w-md-auto my-2 my-md-auto  w-lg-100 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                inline: true,\n                label: \"Baleares\",\n                name: \"baleares\",\n                type: \"checkbox\",\n                id: \"baleares\",\n                className: \"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                inline: true,\n                label: \"Santa justa\",\n                name: \"santa_justa\",\n                type: \"checkbox\",\n                id: \"santa_justa\",\n                className: \"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(CategoriaEdicion, {\n            nombre: \"identificacion\",\n            icono: /*#__PURE__*/_jsxDEV(FaFingerprint, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 74\n            }, this),\n            children: [/*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"ID\",\n              value: id,\n              hoder: \"Id del producto\",\n              lock: true,\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"codigo_barras\",\n              value: codigo_barras,\n              hoder: \"Codigo de barras del producto\",\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"codisis_id\",\n              value: codisis_id,\n              hoder: \"Codigo de barras del producto\",\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(CategoriaEdicion, {\n            nombre: \"valor\",\n            icono: /*#__PURE__*/_jsxDEV(FaEuroSign, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 65\n            }, this),\n            children: [/*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"Precio\",\n              value: precio,\n              hoder: \"Precio del producto\",\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-2\",\n              as: Col,\n              xs: 12,\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"IVA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                id: \"iva\",\n                onChange: handleDropdowns,\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  children: iva ? iva : \"IVA del producto\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"10\",\n                  children: \"10%\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"4\",\n                  children: \"4%\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"21\",\n                  children: \"21%\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(CategoriaEdicion, {\n            nombre: \"empaquetado\",\n            icono: /*#__PURE__*/_jsxDEV(FaBox, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 71\n            }, this),\n            children: [/*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"Unidades\",\n              value: unidades,\n              holder: \"unidades por caja\",\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"Paquetes\",\n              value: paquetes,\n              holder: \"paquetes por caja\",\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(FormItem, {\n              nombre: \"Peso\",\n              value: peso,\n              holder: \"peso del paquete\",\n              handleChange: handleSave,\n              saved: saved\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 9\n  }, this);\n};\n\n_s3(Editor, \"J0b7lC4Uv8U19YL5aiK21r7vB0M=\", false, function () {\n  return [useParams, useProducto];\n});\n\n_c4 = Editor;\nexport default Editor;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"FormItem\");\n$RefreshReg$(_c2, \"CategoriaEdicion\");\n$RefreshReg$(_c3, \"Categoria\");\n$RefreshReg$(_c4, \"Editor\");","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/components/superAdmin/ProductoEditor.js"],"names":["React","useEffect","useRef","useState","MainHolder","Link","useParams","useProducto","Col","Form","Row","InputGroup","Spinner","FaAdjust","FaEuroSign","FaBox","FaFingerprint","FaLock","FaShareAlt","FaThumbsUp","FaAngleRight","FaAngleLeft","Producto","SecondaryHolder","FormItem","props","nombre","value","holder","lock","cambios","handleChange","saved","initial","setInitial","autosave","setAutosave","saving","Object","keys","includes","toLowerCase","setValue","event","val","target","trim","newCambio","newChanges","assign","handleItemChange","console","log","clearTimeout","setTimeout","CategoriaEdicion","children","icono","active","setActive","Categoria","id","Editor","productos","categorias","upgradeProducto","current","setCurrent","setCambios","setSaved","find","p","getCategoria","catId","categoria","c","save","handleSave","window","handleDropdowns","categoria_id","iva","precio","unidades","paquetes","peso","codigo_barras","codisis_id","map"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport MainHolder from '../common/MainHolder'\nimport { Link, useParams } from \"react-router-dom\";\nimport { useProducto } from '../../contexts/ProductoContext';\nimport { Col, Form, Row, InputGroup, Spinner } from 'react-bootstrap';\nimport { FaAdjust, FaEuroSign, FaBox, FaFingerprint, FaLock, FaShareAlt, FaThumbsUp, FaAngleRight, FaAngleLeft } from 'react-icons/fa';\nimport Producto from './ProductoClasificable'\nimport SecondaryHolder from '../common/SecondaryHolder';\n\n\n\nconst FormItem = (props) => {\n    const { nombre, value, holder, lock = false, cambios, handleChange, saved } = props\n    const [initial, setInitial] = useState(value)\n    const [autosave, setAutosave] = useState(null)\n    const saving = (cambios && Object.keys(cambios).includes(nombre.toLowerCase()) && autosave)\n\n\n    const setValue = (event) => {\n        const val = event.target.value.trim().toLowerCase()\n        var newCambio = {}\n        if (initial !== val) {\n            newCambio[nombre.toLowerCase()] = val\n            const newChanges = Object.assign({}, cambios, newCambio)\n\n            setInitial(val)\n            handleChange(newChanges)\n        } else {\n\n        }\n    }\n\n\n    const handleItemChange = (event) => {\n        console.log(initial)\n        const val = event.target.value\n        if ((val !== \"\") && (initial !== val)) {\n            if (autosave) {\n                console.log(\"sigues escribiendo\")\n                clearTimeout(autosave)\n                setAutosave(setTimeout(() => { setValue(event) }, 2000))\n            } else {\n                console.log(\"has empezado a escribir\")\n                setAutosave(setTimeout(() => { setValue(event) }, 2000))\n            }\n        } else {\n            console.log(\"los valores de inicio y actual coinciden\")\n            clearTimeout(autosave)\n            setAutosave(false)\n        }\n\n    }\n\n\n    return (\n        <Form.Group className=\"mb-2\" as={Col} xs={12}>\n            <Form.Label>\n                {nombre}\n            </Form.Label>\n            <InputGroup className=\"mb-2\">\n\n                <Form.Control placeholder={value ? value : holder} readOnly={lock} onChange={handleItemChange} />\n\n\n                {lock && <InputGroup.Text className=\"text-warning fs-1 bg-transparent\"><FaLock /></InputGroup.Text>}\n                {(saving && !saved) && <InputGroup.Text className=\"text-warning fs-1 bg-transparent\"><Spinner animation=\"grow\" /></InputGroup.Text>}\n\n            </InputGroup>\n\n        </Form.Group>\n\n    )\n}\n\n\n\nconst CategoriaEdicion = (props) => {\n    const { children, nombre, icono } = props\n\n    const [active, setActive] = useState(false)\n\n    return (\n\n        <Col sm={12} lg={12} xl={6} className={`${active ? \"border\" : \"border-top\"} border-white border-3 rounded rounded-2 px-2 mb-sm-2 h-auto my-2`}>\n\n            <Col xs={12} className={`${!active ? \"border border-3\" : \"border-bottom\"} border-white fs-3 d-flex py-auto justify-content-center  text-white`} onClick={() => setActive(!active)}>\n                <span className=\"me-2 text-capitalize\">{nombre}</span>\n                <span>{icono}</span>\n            </Col>\n\n            <Col xs={12} className=\"px-2\">\n                {active && children}\n\n            </Col>\n\n\n\n        </Col>\n    )\n}\n\n\nconst Categoria = (props) => {\n    const { nombre, id } = props\n\n    return <option value={id}>{nombre}</option>\n}\n\n\nconst Editor = (props) => {\n    const { id } = useParams();\n    const { productos, categorias, upgradeProducto } = useProducto()\n    const [current, setCurrent] = useState({})\n    const [cambios, setCambios] = useState(null)\n    const [autosave, setAutosave] = useState(null)\n    const [saved, setSaved] = useState(false)\n\n    useEffect(() => {\n        productos && setCurrent(productos.find(p => p.id == id))\n    }, [productos])\n\n    useEffect(() => {\n        cambios && upgradeProducto(id, cambios)\n    }, [cambios])\n\n    const getCategoria = (catId) => {\n        const categoria = categorias.find(c => c.id === catId)\n        return categoria\n    }\n\n    const save = (cambios) => {\n        console.log(\"Guardando los cambios en firebase\")\n        setCambios(cambios)\n        setSaved(true)\n    }\n\n    const handleSave = (cambios) => {\n        console.log(\"cambio requrido\")\n        console.log(cambios)\n        setSaved(false)\n        if (autosave) {\n            console.log(\"sigues modificando el formulario\")\n            window.clearTimeout(autosave)\n            setAutosave(window.setTimeout(() => { save(cambios) }, 5000))\n        } else {\n            console.log(\"has modificado el formulario\")\n            setAutosave(window.setTimeout(() => { save(cambios) }, 5000))\n        }\n    }\n\n    const handleDropdowns = (event) => {\n        const { value, id } = event.target\n\n        console.log(id)\n        if (id === \"categorias\") {\n            handleSave(Object.assign({}, cambios, { categoria_id: value }))\n        }\n        if (id === \"iva\") {\n            handleSave(Object.assign({}, cambios, { iva: value }))\n        }\n    }\n\n\n\n\n    const { nombre, precio, unidades, paquetes, peso, iva, categoria_id } = current\n    const { codigo_barras, codisis_id } = current\n    const categoria = categoria_id && getCategoria(categoria_id)\n\n    return (\n        <SecondaryHolder title={\"Editar - \"+nombre} back=\"/productos\">\n            <Row className=\"justify-content-center justify-content-lg-around mx-auto w-100 align-items-center pt-2\" >\n\n                \n                <Col xs={12} md={8} lg={4} xl={3} className=\"d-flex  justify-content-center align-items-center \">\n                    {productos && <Producto {...current} editable={true} expand={true} />}\n                </Col>\n\n                <Col md={12} lg={7} xl={8} className=\" text-white py-2 px-0\" >\n                    <Form as={Row} className=\"bg-oscuro justify-content-around\">\n\n\n\n                        <FormItem nombre=\"Nombre\" value={nombre} holder=\"Nombre del producto\" handleChange={handleSave} cambios={cambios} saved={saved} />\n                        <Form.Group className=\"mb-2\" as={Col} xs={12} >\n                            <Form.Label>Categoria</Form.Label>\n                            <Form.Select id=\"categorias\" onChange={handleDropdowns}>\n                                {categoria ? <Categoria {...categoria} /> : <option> Categoria del producto </option>}\n                                {categorias && categorias.map(c => c.id !== categoria_id ? <Categoria {...c} /> : null)}\n                            </Form.Select>\n                        </Form.Group>\n\n                        <CategoriaEdicion nombre=\"exclusivo\">\n\n                            <Form.Group className=\"mb-2 ps-3 ps-md-0 d-sm-flex d-lg-block justify-content-center pt-2 bg-info\" as={Col} xs={12} >\n                                <Form.Check\n                                    inline\n                                    label=\"No\"\n                                    name=\"no_exclusivo\"\n                                    type='checkbox'\n                                    id='no'\n                                    className=\"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n\n\n                                />\n                                <Form.Check\n                                    inline\n                                    label=\"Andalucia\"\n                                    name=\"andalucia\"\n                                    type='checkbox'\n                                    id='andalucia'\n                                    className=\"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n\n\n                                />\n                                <Form.Check\n                                    inline\n                                    label=\"Levante\"\n                                    name=\"levante\"\n                                    type='checkbox'\n                                    id='levante'\n                                    className=\"w-100 w-md-auto  my-2 my-md-auto w-lg-100 \"\n                                />\n\n                                <Form.Check\n                                    inline\n                                    label=\"Canarias\"\n                                    name=\"canarias\"\n                                    type='checkbox'\n                                    id='canarias'\n                                    className=\"w-100 w-md-auto my-2 my-md-auto  w-lg-100 \"\n\n                                />\n\n                                <Form.Check\n                                    inline\n                                    label=\"Baleares\"\n                                    name=\"baleares\"\n                                    type='checkbox'\n                                    id='baleares'\n                                    className=\"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n\n                                />\n\n                                <Form.Check\n                                    inline\n                                    label=\"Santa justa\"\n                                    name=\"santa_justa\"\n                                    type='checkbox'\n                                    id='santa_justa'\n                                    className=\"w-100 w-md-auto  my-2 my-md-auto  w-lg-100 \"\n\n                                />\n\n\n\n                            </Form.Group>\n\n\n\n                        </CategoriaEdicion>\n\n                        <CategoriaEdicion nombre=\"identificacion\" icono={<FaFingerprint />}>\n\n                            <FormItem nombre=\"ID\" value={id} hoder=\"Id del producto\" lock handleChange={handleSave} saved={saved} />\n                            <FormItem nombre=\"codigo_barras\" value={codigo_barras} hoder=\"Codigo de barras del producto\" handleChange={handleSave} saved={saved} />\n                            <FormItem nombre=\"codisis_id\" value={codisis_id} hoder=\"Codigo de barras del producto\" handleChange={handleSave} saved={saved} />\n\n\n                        </CategoriaEdicion>\n\n                        <CategoriaEdicion nombre=\"valor\" icono={<FaEuroSign />}>\n\n                            <FormItem nombre=\"Precio\" value={precio} hoder=\"Precio del producto\" handleChange={handleSave} saved={saved} />\n\n                            <Form.Group className=\"mb-2\" as={Col} xs={12}>\n                                <Form.Label>IVA</Form.Label>\n                                <Form.Select id=\"iva\" onChange={handleDropdowns}>\n                                    <option>{iva ? iva : \"IVA del producto\"}</option>\n                                    <option value=\"10\">10%</option>\n                                    <option value=\"4\">4%</option>\n                                    <option value=\"21\">21%</option>\n                                </Form.Select>\n                            </Form.Group>\n                        </CategoriaEdicion>\n\n\n\n                        <CategoriaEdicion nombre=\"empaquetado\" icono={<FaBox />}>\n\n                            <FormItem nombre=\"Unidades\" value={unidades} holder=\"unidades por caja\" handleChange={handleSave} saved={saved} />\n\n                            <FormItem nombre=\"Paquetes\" value={paquetes} holder=\"paquetes por caja\" handleChange={handleSave} saved={saved} />\n\n                            <FormItem nombre=\"Peso\" value={peso} holder=\"peso del paquete\" handleChange={handleSave} saved={saved} />\n\n                        </CategoriaEdicion>\n\n\n\n                    </Form>\n                </Col>\n\n            </Row>\n\n        </SecondaryHolder>\n    )\n}\n\n\nexport default Editor"]},"metadata":{},"sourceType":"module"}