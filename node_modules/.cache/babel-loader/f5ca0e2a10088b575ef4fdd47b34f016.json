{"ast":null,"code":"import _objectSpread from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{database}from'../firebase';import{jsx as _jsx}from\"react/jsx-runtime\";var ProductoContext=/*#__PURE__*/React.createContext();export function useProducto(){return React.useContext(ProductoContext);}export function ProductoProvider(_ref){var children=_ref.children;var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),productos=_React$useState2[0],setProductos=_React$useState2[1];var _React$useState3=React.useState(),_React$useState4=_slicedToArray(_React$useState3,2),categorias=_React$useState4[0],setCategorias=_React$useState4[1];var value={productos:productos,categorias:categorias,loadProductoContext:loadProductoContext,upgradeProducto:upgradeProducto,upgradeProductoBulk:upgradeProductoBulk};function loadProducto(){var productosRef=database.collection(\"productos\");productosRef.get().then(function(querySnapshot){var lista=[];querySnapshot.forEach(function(documentSnapshot){lista.push(_objectSpread({id:documentSnapshot.id},documentSnapshot.data()));});setProductos(lista);}).catch(function(error){console.log(error);});}function loadProductoContext(){loadProducto();database.collection(\"categorias_producto\").get().then(function(query){var lista=[];query.forEach(function(document){lista.push(_objectSpread({id:document.id},document.data()));});setCategorias(lista);});}function upgradeProducto(prodID,data,deleteKey){console.log(prodID);database.collection(\"productos\").doc(prodID).update(data).then(function(){console.log(\"exito?\");var newProductos=productos.map(function(producto){var match=producto.id==prodID;data=deleteKey?{categoria_id:undefined}:data;return match?Object.assign({},producto,data):producto;});setProductos(newProductos);});}function upgradeProductoBulk(productosID,data,deleteKey){var batch=database.batch();var nuevosProductos=[];productosID.forEach(function(prodID){var ref=database.collection(\"productos\").doc(prodID);batch.update(ref,data);data=deleteKey?{categoria_id:undefined}:data;var producto=productos.find(function(p){return p.id==productosID;});producto=Object.assign({},producto,data);nuevosProductos.push(producto);});batch.commit().then(function(){var dataProductos=productos.map(function(producto){var nuevoProducto=nuevosProductos.find(function(np){return np.id===producto.id;});nuevoProducto&&console.log(nuevosProductos);return nuevoProducto?nuevoProducto:producto;});setProductos(dataProductos);});}return/*#__PURE__*/_jsx(ProductoContext.Provider,{value:value,children:children});}","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/contexts/ProductoContext.js"],"names":["React","useState","useEffect","database","ProductoContext","createContext","useProducto","useContext","ProductoProvider","children","productos","setProductos","categorias","setCategorias","value","loadProductoContext","upgradeProducto","upgradeProductoBulk","loadProducto","productosRef","collection","get","then","querySnapshot","lista","forEach","documentSnapshot","push","id","data","catch","error","console","log","query","document","prodID","deleteKey","doc","update","newProductos","map","producto","match","categoria_id","undefined","Object","assign","productosID","batch","nuevosProductos","ref","find","p","commit","dataProductos","nuevoProducto","np"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { database } from '../firebase'\n\nconst ProductoContext = React.createContext();\n\n\n\nexport function useProducto() {\n    return React.useContext(ProductoContext)\n}\n\n\nexport function ProductoProvider({ children }) {\n\n   \n    const [productos, setProductos] = React.useState();\n    const [categorias, setCategorias] = React.useState();\n\n    const value = {\n        productos,\n        categorias,\n        loadProductoContext,\n        upgradeProducto,\n        upgradeProductoBulk\n    }\n\n    function loadProducto() {\n        const productosRef = database.collection(\"productos\")\n        productosRef.get().then(querySnapshot => {\n           \n            const lista = []\n            querySnapshot.forEach(documentSnapshot => {\n                lista.push({ id: documentSnapshot.id, ...documentSnapshot.data() })\n            });\n            setProductos(lista)\n\n        }).catch(error => {\n            console.log(error)\n        });\n    }\n\n    function loadProductoContext() {\n        loadProducto();\n        database.collection(\"categorias_producto\").get().then(query => {\n            const lista = []\n            query.forEach(document => { lista.push({ id: document.id, ...document.data() }) })\n            \n            setCategorias(lista)\n        })\n    }\n\n    function upgradeProducto(prodID, data, deleteKey) {\n        console.log(prodID)\n\n        database.collection(\"productos\").doc(prodID).update(data).\n            then(() => {\n                console.log(\"exito?\")\n                const newProductos = productos.map((producto) => {\n\n                    const match = (producto.id == prodID)\n                    data = deleteKey ? { categoria_id: undefined } : data\n                    return match ? Object.assign({}, producto, data) : producto\n                })\n                \n                setProductos(newProductos)\n            })\n    }\n\n\n\n    function upgradeProductoBulk(productosID, data, deleteKey) {\n        const batch = database.batch()\n        const nuevosProductos =[]\n        \n        productosID.forEach((prodID) => {\n            \n            const ref = database.collection(\"productos\").doc(prodID)\n            batch.update(ref, data)\n\n            \n            data = deleteKey ? { categoria_id: undefined } : data\n            \n            let producto =productos.find(p=>p.id==productosID)\n            producto=Object.assign({},producto,data)\n            nuevosProductos.push(producto)\n            \n        })\n\n        batch.commit().then(()=>{\n            \n            let dataProductos=productos.map((producto)=>{\n                const nuevoProducto =nuevosProductos.find((np)=>{return np.id===producto.id})\n                nuevoProducto && console.log(nuevosProductos)\n                return nuevoProducto? nuevoProducto:producto\n            })\n\n            setProductos(dataProductos)\n        })\n\n\n\n    }\n\n    return (\n        <ProductoContext.Provider value={value}>\n            {children}\n        </ProductoContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}