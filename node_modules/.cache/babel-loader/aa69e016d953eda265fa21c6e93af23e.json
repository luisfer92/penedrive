{"ast":null,"code":"import _objectSpread from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/luisfer/Escritorio/rerovaji-control/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import firebase,{database,storage}from'../firebase';import{useLocal}from'./LocalContext';import{jsx as _jsx}from\"react/jsx-runtime\";export var CompisContext=/*#__PURE__*/React.createContext();export function useCompis(){return React.useContext(CompisContext);}export function CompisProvider(_ref){var children=_ref.children;var _useLocal=useLocal(),local=_useLocal.local;var _useState=useState(),_useState2=_slicedToArray(_useState,2),compis=_useState2[0],setCompis=_useState2[1];useEffect(function(){local&&console.log(\"buscando compis\"+local.allowed_users);var newCompis=[];local&&database.collection(\"usuarios\").where('correo','in',local.allowed_users).get().then(function(query){query.forEach(function(c){var id=c.id;storage.ref(\"fotos_perfil/\".concat(id,\".png\")).getDownloadURL().then(function(url){var data=Object.assign({},c.data(),{pic_url:url});console.log(data);newCompis.push(_objectSpread({id:id},data));});});console.log(\"compis encontrados\");console.log(newCompis);setCompis(newCompis);});},[setCompis,local]);var value={compis:compis};return/*#__PURE__*/_jsx(CompisContext.Provider,{value:value,children:children});}","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/contexts/CompisContext.js"],"names":["React","useEffect","useState","firebase","database","storage","useLocal","CompisContext","createContext","useCompis","useContext","CompisProvider","children","local","compis","setCompis","console","log","allowed_users","newCompis","collection","where","get","then","query","forEach","c","id","ref","getDownloadURL","url","data","Object","assign","pic_url","push","value"],"mappings":"+TAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,QAAP,EAAmBC,QAAnB,CAA6BC,OAA7B,KAA4C,aAA5C,CAGA,OAASC,QAAT,KAAyB,gBAAzB,C,2CAGA,MAAO,IAAMC,CAAAA,aAAa,cAAGP,KAAK,CAACQ,aAAN,EAAtB,CAKP,MAAO,SAASC,CAAAA,SAAT,EAAqB,CACxB,MAAOT,CAAAA,KAAK,CAACU,UAAN,CAAiBH,aAAjB,CAAP,CACH,CACD,MAAO,SAASI,CAAAA,cAAT,MAAsC,IAAZC,CAAAA,QAAY,MAAZA,QAAY,CACzC,cAAkBN,QAAQ,EAA1B,CAAQO,KAAR,WAAQA,KAAR,CACA,cAA4BX,QAAQ,EAApC,wCAAOY,MAAP,eAAeC,SAAf,eAKAd,SAAS,CAAC,UAAM,CACZY,KAAK,EAAIG,OAAO,CAACC,GAAR,CAAY,kBAAoBJ,KAAK,CAACK,aAAtC,CAAT,CAEA,GAAIC,CAAAA,SAAS,CAAG,EAAhB,CACAN,KAAK,EAAIT,QAAQ,CAACgB,UAAT,CAAoB,UAApB,EAAgCC,KAAhC,CAAsC,QAAtC,CAAgD,IAAhD,CAAsDR,KAAK,CAACK,aAA5D,EAA2EI,GAA3E,GAAiFC,IAAjF,CAAsF,SAACC,KAAD,CAAW,CACtGA,KAAK,CAACC,OAAN,CACI,SAACC,CAAD,CAAO,CAEH,GAAQC,CAAAA,EAAR,CAAeD,CAAf,CAAQC,EAAR,CACAtB,OAAO,CAACuB,GAAR,wBAA4BD,EAA5B,UAAsCE,cAAtC,GAAuDN,IAAvD,CAA4D,SAACO,GAAD,CAAS,CAEjE,GAAMC,CAAAA,IAAI,CAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,CAAkBP,CAAC,CAACK,IAAF,EAAlB,CAA4B,CAAEG,OAAO,CAAEJ,GAAX,CAA5B,CAAb,CACAd,OAAO,CAACC,GAAR,CAAYc,IAAZ,EACAZ,SAAS,CAACgB,IAAV,gBAAiBR,EAAE,CAAFA,EAAjB,EAAwBI,IAAxB,GACH,CALD,EAQH,CAZL,EAcAf,OAAO,CAACC,GAAR,CAAY,oBAAZ,EACAD,OAAO,CAACC,GAAR,CAAYE,SAAZ,EACAJ,SAAS,CAACI,SAAD,CAAT,CACH,CAlBQ,CAAT,CAoBH,CAxBQ,CAwBN,CAACJ,SAAD,CAAYF,KAAZ,CAxBM,CAAT,CA4BA,GAAMuB,CAAAA,KAAK,CAAG,CACVtB,MAAM,CAANA,MADU,CAAd,CAMA,mBACI,KAAC,aAAD,CAAe,QAAf,EAAwB,KAAK,CAAEsB,KAA/B,UACKxB,QADL,EADJ,CAKH","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport firebase, { database, storage } from '../firebase'\n\n\nimport { useLocal } from './LocalContext'\n\n\nexport const CompisContext = React.createContext();\n\n\n\n\nexport function useCompis() {\n    return React.useContext(CompisContext)\n}\nexport function CompisProvider({ children }) {\n    const { local } = useLocal()\n    const [compis, setCompis] = useState()\n\n\n\n\n    useEffect(() => {\n        local && console.log(\"buscando compis\" + local.allowed_users)\n\n        let newCompis = []\n        local && database.collection(\"usuarios\").where('correo', 'in', local.allowed_users).get().then((query) => {\n            query.forEach(\n                (c) => {\n                    \n                    const { id } = c\n                    storage.ref(`fotos_perfil/${id}.png`).getDownloadURL().then((url) => { \n                       \n                        const data = Object.assign({}, c.data(), { pic_url: url }) \n                        console.log(data)\n                        newCompis.push({ id, ...data })\n                    })\n\n                   \n                }\n            )\n            console.log(\"compis encontrados\")\n            console.log(newCompis)\n            setCompis(newCompis)\n        })\n\n    }, [setCompis, local])\n\n\n\n    const value = {\n        compis,\n\n    }\n\n\n    return (\n        <CompisContext.Provider value={value}>\n            {children}\n        </CompisContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}