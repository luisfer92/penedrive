{"ast":null,"code":"var _jsxFileName = \"/home/luisfer/Escritorio/rerovaji-control/src/components/common/Messenger.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\n/* eslint-disable import/no-anonymous-default-export */\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Col, Form, Row, InputGroup, Button } from 'react-bootstrap';\nimport { FaBeer, FaBullhorn, FaExclamationTriangle } from 'react-icons/fa';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useCompis } from '../../contexts/CompisContext';\nimport { useMesage } from '../../contexts/MessageContext';\nimport MainHolder from './MainHolder';\nimport moment from 'moment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst getFormated = date => {\n  console.log(\"formateando\");\n  var duration = moment.duration(moment().diff(date));\n  var minutes = duration.asMinutes();\n  var days = duration.asDays();\n  const menosDe30 = minutes < 30;\n  const ayer = days >= 1 && days < 2;\n  const hoy = days > 0 && days < 1 && !menosDe30;\n  const isProximo = menosDe30 || ayer || hoy;\n\n  const _getFormated = () => {\n    let formated = null;\n    const soloHoras = date.format(\"HH:MM\");\n\n    switch (true) {\n      case !isProximo:\n        formated = date.format(\"ddd. DD-MM-YY HH:MM\");\n        break;\n\n      case ayer:\n        formated = \"ayer \" + soloHoras;\n        break;\n\n      case hoy:\n        formated = soloHoras;\n        break;\n\n      case minutes < 1:\n        formated = \"ahora mismo\";\n        break;\n\n      case menosDe30:\n        formated = \"hace \" + Math.round(minutes) + \" minutos\";\n        break;\n\n      default:\n        console.log();\n        break;\n    }\n\n    return formated;\n  };\n\n  return _getFormated();\n};\n\nconst MsgFecha = props => {\n  _s();\n\n  const {\n    date\n  } = props;\n  const [formated, setFormated] = useState(getFormated(date));\n  useEffect(() => {\n    const timer = setInterval(() => {\n      const newTime = getFormated(date);\n      newTime != formated && setFormated(getFormated(date));\n    }, 60000);\n    return () => clearInterval(timer);\n  }, [setFormated]);\n  return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"w-100 m-0 p-0 text-end pe-2 text-warning\",\n    children: formated\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 12\n  }, this);\n};\n\n_s(MsgFecha, \"ikTEk2oCt4MAYtawiiKtju8zowg=\");\n\n_c = MsgFecha;\n\nconst MsgFrom = props => {\n  _s2();\n\n  const {\n    userAPI\n  } = useAuth();\n  const {\n    children,\n    from,\n    date,\n    __type\n  } = props;\n  const {\n    compis\n  } = useCompis();\n  const [me, setMe] = useState();\n  const [itsMine, setItsMine] = useState(false);\n  useEffect(() => {\n    if (compis && userAPI) {\n      const find = compis.find(c => c.correo === from);\n      find && console.log(find.id);\n      console.log(userAPI);\n      setItsMine(find && find.id === userAPI.id);\n      setMe(find);\n    }\n  }, [setMe, compis]);\n  console.log(date);\n  return /*#__PURE__*/_jsxDEV(Row, {\n    className: `justify-content-center px-0 mx-auto  ${itsMine && \"flex-row-reverse\"}`,\n    children: [/*#__PURE__*/_jsxDEV(Col, {\n      xs: true,\n      sm: 5,\n      lg: 4,\n      className: \"d-flex align-items-center text-white \",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        className: \"w-100 mx-auto p-0 text-dark\",\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          xs: 12,\n          className: \"mx-auto text-capitalize text-white\",\n          children: me && me.nombre\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          xs: 12,\n          className: ` shadow mx-auto py-3 text-start ${itsMine ? \"bocadillo-me\" : \"bocadillo\"} ${__type == \"alarm\" && \"bg-oscuro  text-amarillo\"} border border-3 border-white d-flex align-items-center `,\n          children: children\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(MsgFecha, {\n          date: date\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Col, {\n      xs: 2,\n      md: 1,\n      className: \"d-flex justify-content-center  align-items-center\",\n      children: me && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: me.pic_url,\n        style: {\n          width: \"48px\",\n          height: \"48px\"\n        },\n        className: \"rounded-circle border border-3 border-white shadow\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 24\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(MsgFrom, \"sbCYXfYBOto3xvjaWb1jP4WnZ7A=\", false, function () {\n  return [useAuth, useCompis];\n});\n\n_c2 = MsgFrom;\n\nconst Mensaje = props => {\n  const {\n    msg,\n    date,\n    author,\n    __type\n  } = props;\n  return /*#__PURE__*/_jsxDEV(Row, {\n    className: \"mx-auto justify-content-center my-2 w-100\",\n    children: /*#__PURE__*/_jsxDEV(MsgFrom, {\n      from: author,\n      date: date,\n      __type: __type,\n      children: [__type == \"alarm\" && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"position-absolute text-white\",\n        style: {\n          top: \"-10px\",\n          right: \"-10px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(FaBullhorn, {\n          className: \"m-0 p-0\",\n          size: 25\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 25\n      }, this), msg]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 9\n  }, this);\n};\n\n_c3 = Mensaje;\nexport default function () {\n  const {\n    mensajes,\n    sendMensaje\n  } = useMesage();\n  const [type, setType] = useState();\n  const msgText = useRef();\n  const msgsBottom = useRef(null);\n  useEffect(() => {\n    if (msgsBottom) msgsBottom.current.scrollTop = msgsBottom.current.scrollHeight * 2;\n  }, [mensajes]);\n\n  const handleSend = () => {\n    if (msgText.current) {\n      const text = msgText.current.value;\n      text != \"\" && sendMensaje({\n        msg: text\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(MainHolder, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-100 p-0 m-0 d-flex bg-oscuro-claro flex-column justify-content-end\",\n      style: {\n        height: \"80%\",\n        overflow: \"hidden\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"py-5 position-relative\",\n        style: {\n          maxHeight: \"100%\",\n          overflowX: \"hidden\",\n          overflowY: \"scroll\"\n        },\n        ref: msgsBottom,\n        children: [mensajes && mensajes.map(m => /*#__PURE__*/_jsxDEV(Mensaje, { ...m\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 52\n        }, this)), /*#__PURE__*/_jsxDEV(Row, {\n          className: \"bg-info \",\n          style: {\n            bottom: \"0\",\n            height: \"10vh\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-warning m-0 w-100  position-absolute bg-dark d-flex border-top border-3 border-white\",\n      style: {\n        minHeight: \"20%\",\n        bottom: \"0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        className: \"my-auto mx-auto  p-2 w-100\",\n        children: /*#__PURE__*/_jsxDEV(Form.Group, {\n          className: \"mb-2\",\n          children: /*#__PURE__*/_jsxDEV(InputGroup, {\n            children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n              as: \"textarea\",\n              ref: msgText,\n              className: \"rounded rounded-4\",\n              placeHolder: \"mensaje...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(InputGroup.Text, {\n              as: Button,\n              onClick: handleSend,\n              variant: \"success px-4\",\n              children: \"Enviar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 9\n  }, this);\n}\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"MsgFecha\");\n$RefreshReg$(_c2, \"MsgFrom\");\n$RefreshReg$(_c3, \"Mensaje\");","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/components/common/Messenger.js"],"names":["React","useEffect","useRef","useState","Col","Form","Row","InputGroup","Button","FaBeer","FaBullhorn","FaExclamationTriangle","useAuth","useCompis","useMesage","MainHolder","moment","getFormated","date","console","log","duration","diff","minutes","asMinutes","days","asDays","menosDe30","ayer","hoy","isProximo","_getFormated","formated","soloHoras","format","Math","round","MsgFecha","props","setFormated","timer","setInterval","newTime","clearInterval","MsgFrom","userAPI","children","from","__type","compis","me","setMe","itsMine","setItsMine","find","c","correo","id","nombre","pic_url","width","height","Mensaje","msg","author","top","right","mensajes","sendMensaje","type","setType","msgText","msgsBottom","current","scrollTop","scrollHeight","handleSend","text","value","overflow","maxHeight","overflowX","overflowY","map","m","bottom","minHeight"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-anonymous-default-export */\nimport React, { useEffect, useRef, useState } from 'react'\nimport { Col, Form, Row, InputGroup, Button } from 'react-bootstrap'\nimport { FaBeer, FaBullhorn, FaExclamationTriangle } from 'react-icons/fa'\nimport { useAuth } from '../../contexts/AuthContext'\nimport { useCompis } from '../../contexts/CompisContext'\nimport { useMesage } from '../../contexts/MessageContext'\nimport MainHolder from './MainHolder'\nimport moment from 'moment'\n\n\nconst getFormated = (date) => {\n    console.log(\"formateando\")\n    var duration = moment.duration(moment().diff(date));\n\n    var minutes = duration.asMinutes()\n    var days = duration.asDays()\n\n\n    const menosDe30 = minutes < 30\n    const ayer = days >= 1 && days < 2\n    const hoy = (days > 0 && days < 1) && !menosDe30\n\n    const isProximo = (menosDe30 || ayer || hoy)\n\n    const _getFormated = () => {\n        let formated = null\n        const soloHoras = date.format(\"HH:MM\")\n        switch (true) {\n            case (!isProximo):\n                formated = date.format(\"ddd. DD-MM-YY HH:MM\")\n                break\n            case (ayer):\n                formated = \"ayer \" + soloHoras\n                break\n\n            case (hoy):\n                formated = soloHoras\n                break\n\n            case (minutes < 1):\n                formated = \"ahora mismo\"\n                break;\n            case (menosDe30):\n                formated = \"hace \" + Math.round(minutes) + \" minutos\"\n                break\n\n            default:\n                console.log()\n                break;\n        }\n        return formated\n    }\n    return _getFormated()\n}\n\n\n\n\nconst MsgFecha = (props) => {\n    const { date } = props\n    const [formated, setFormated] = useState(getFormated(date))\n\n    useEffect(() => {\n\n        const timer = setInterval(() => {\n            const newTime = getFormated(date)\n            newTime != formated && setFormated(getFormated(date))\n        }, 60000)\n\n        return () => clearInterval(timer);\n    }, [setFormated])\n\n    return <p className=\"w-100 m-0 p-0 text-end pe-2 text-warning\">{formated}</p>\n}\n\n\nconst MsgFrom = (props) => {\n    const { userAPI } = useAuth()\n    const { children, from, date, __type } = props\n    const { compis } = useCompis()\n    const [me, setMe] = useState()\n    const [itsMine, setItsMine] = useState(false)\n\n    useEffect(() => {\n\n        if (compis && userAPI) {\n\n            const find = compis.find(c => c.correo === from)\n            find && console.log(find.id)\n            console.log(userAPI)\n            setItsMine(find && find.id === userAPI.id)\n            setMe(find)\n        }\n    }, [setMe, compis])\n\n    console.log(date)\n\n\n    return (\n        <Row className={`justify-content-center px-0 mx-auto  ${itsMine && \"flex-row-reverse\"}`}>\n            <Col xs sm={5} lg={4} className=\"d-flex align-items-center text-white \">\n                <Row className=\"w-100 mx-auto p-0 text-dark\">\n                    <Col xs={12} className=\"mx-auto text-capitalize text-white\">{me && me.nombre}</Col>\n                    <Col xs={12} className={` shadow mx-auto py-3 text-start ${itsMine ? \"bocadillo-me\" : \"bocadillo\"} ${__type == \"alarm\" && \"bg-oscuro  text-amarillo\"} border border-3 border-white d-flex align-items-center `}>\n                        {children}\n                    </Col>\n                    <MsgFecha date={date} />\n                </Row>\n\n            </Col>\n            <Col xs={2} md={1} className=\"d-flex justify-content-center  align-items-center\">\n\n                {me && <img src={me.pic_url} style={{ width: \"48px\", height: \"48px\" }} className=\"rounded-circle border border-3 border-white shadow\" />}\n\n\n            </Col>\n\n\n\n        </Row >\n\n    )\n}\n\n\nconst Mensaje = (props) => {\n    const { msg, date, author, __type } = props\n\n    return (\n        <Row className=\"mx-auto justify-content-center my-2 w-100\">\n            <MsgFrom from={author} date={date} __type={__type}>\n\n                {\n                    __type == \"alarm\" &&\n                        <div className=\"position-absolute text-white\" style={{ top: \"-10px\", right: \"-10px\" }}>\n                            <FaBullhorn className=\"m-0 p-0\" size={25} />\n                        </div>\n                }\n                {msg}\n\n\n\n            </MsgFrom>\n\n        </Row>\n\n    )\n}\n\n\n\nexport default function () {\n    const { mensajes, sendMensaje } = useMesage()\n    const [type, setType] = useState()\n    const msgText = useRef()\n    const msgsBottom = useRef(null)\n\n\n    useEffect(() => {\n        if (msgsBottom) msgsBottom.current.scrollTop = msgsBottom.current.scrollHeight *2\n    }, [mensajes])\n\n\n    const handleSend = () => {\n        if (msgText.current) {\n            const text = msgText.current.value\n            text != \"\" && sendMensaje({ msg: text })\n        }\n    }\n\n\n    return (\n        <MainHolder>\n\n            <div className=\"w-100 p-0 m-0 d-flex bg-oscuro-claro flex-column justify-content-end\" style={{ height: \"80%\", overflow: \"hidden\" }} >\n                <div className=\"py-5 position-relative\" style={{ maxHeight: \"100%\", overflowX: \"hidden\", overflowY: \"scroll\" }}ref={msgsBottom}  >\n                    {mensajes && mensajes.map(m => <Mensaje {...m} />)}\n                    <Row className=\"bg-info \" style={{bottom:\"0\" ,height: \"10vh\" }} />\n                </div>\n\n            </div>\n\n\n\n\n            <div className=\"bg-warning m-0 w-100  position-absolute bg-dark d-flex border-top border-3 border-white\" style={{ minHeight: \"20%\", bottom: \"0\" }}>\n                <Form className=\"my-auto mx-auto  p-2 w-100\">\n\n                    <Form.Group className=\"mb-2\">\n                        <InputGroup>\n\n                            <Form.Control as=\"textarea\" ref={msgText} className=\"rounded rounded-4\" placeHolder={\"mensaje...\"} />\n                            <InputGroup.Text as={Button} onClick={handleSend} variant=\"success px-4\">Enviar</InputGroup.Text>\n                        </InputGroup>\n                    </Form.Group>\n\n\n                </Form>\n            </div>\n        </MainHolder>\n\n    )\n}"]},"metadata":{},"sourceType":"module"}