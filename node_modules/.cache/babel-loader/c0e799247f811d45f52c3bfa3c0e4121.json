{"ast":null,"code":"var _jsxFileName = \"/home/luisfer/Escritorio/rerovaji-control/src/contexts/TrabajadorContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { database } from '../firebase';\nimport { ContratoContext } from './ContratoContext';\nimport { storage } from '../firebase';\nimport { useLocal } from './LocalContext';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const TrabajadorContext = /*#__PURE__*/React.createContext();\nexport function useTrabajador() {\n  _s();\n\n  return React.useContext(TrabajadorContext);\n}\n\n_s(useTrabajador, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function TrabajadorProvider({\n  children\n}) {\n  _s2();\n\n  const {\n    local\n  } = useLocal();\n  const {\n    registerUser\n  } = useAuth();\n  const [trabajadores, setTrabajadores] = useState();\n  const [selfDB, setDB] = useState();\n  console.log(local);\n\n  const registerUserInLocal = data => {\n    registerUser(data.correo);\n    storage.ref(`fotos_perfil/${\"patata\"}.webp`).putString(data.foto, 'data_url').then(q => {\n      console.log(\"foto subida ve y mira marico\");\n    });\n  };\n\n  useEffect(() => {\n    if (local) {\n      const db = database.collection(\"locales\").doc(local.id).collection(\"plantilla\");\n      setDB(db);\n    }\n  }, [local]);\n  useEffect(() => {\n    let unsubscribe = null;\n\n    if (selfDB) {\n      const plantilla = [];\n      console.log(\"carga inicial trabajadores\");\n      selfDB.orderBy(\"nombre\").onSnapshot(snap => {\n        snap.forEach(t => {\n          console.log(t.data());\n          plantilla.push({\n            id: t.id,\n            ...t.data()\n          });\n        });\n        setTrabajadores(plantilla);\n        console.log(plantilla);\n      });\n    }\n\n    return unsubscribe ? () => unsubscribe() : null;\n  }, [selfDB, setTrabajadores]);\n\n  const createTrabajador = data => {\n    /*\n    selfDB.add(data).then((query) => {\n        console.log(\"lo subii\")\n    })\n    */\n    registerUserInLocal(data);\n  };\n\n  const value = {\n    trabajadores,\n    createTrabajador\n  };\n  return /*#__PURE__*/_jsxDEV(TrabajadorContext.Provider, {\n    value: value,\n    children: /*#__PURE__*/_jsxDEV(ContratoContext.Provider, {\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(TrabajadorProvider, \"qoQ8V4sw+bMu+uBevrtFS31Ltfc=\", false, function () {\n  return [useLocal, useAuth];\n});\n\n_c = TrabajadorProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"TrabajadorProvider\");","map":{"version":3,"sources":["/home/luisfer/Escritorio/rerovaji-control/src/contexts/TrabajadorContext.js"],"names":["React","useEffect","useState","database","ContratoContext","storage","useLocal","useAuth","TrabajadorContext","createContext","useTrabajador","useContext","TrabajadorProvider","children","local","registerUser","trabajadores","setTrabajadores","selfDB","setDB","console","log","registerUserInLocal","data","correo","ref","putString","foto","then","q","db","collection","doc","id","unsubscribe","plantilla","orderBy","onSnapshot","snap","forEach","t","push","createTrabajador","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { database } from '../firebase'\nimport { ContratoContext } from './ContratoContext';\nimport { storage } from '../firebase'\nimport { useLocal } from './LocalContext';\nimport {useAuth} from './AuthContext'\n\n\n\nexport const TrabajadorContext = React.createContext();\n\n\n\n\nexport function useTrabajador() {\n    return React.useContext(TrabajadorContext)\n}\nexport function TrabajadorProvider({ children }) {\n    const { local } = useLocal()\n    const { registerUser } = useAuth()\n    const [trabajadores, setTrabajadores] = useState()\n    const [selfDB, setDB] = useState()\n\n    console.log(local)\n\n\n\n    const registerUserInLocal = (data) => {\n        registerUser(data.correo)\n        storage.ref(`fotos_perfil/${\"patata\"}.webp`).putString(data.foto, 'data_url').then(q => {\n            console.log(\"foto subida ve y mira marico\")\n        })\n    }\n\n\n\n    useEffect(() => {\n\n        if (local) {\n            const db = database.collection(\"locales\").doc(local.id).collection(\"plantilla\")\n            setDB(db)\n\n        }\n\n\n    }, [local])\n\n    useEffect(() => {\n\n        let unsubscribe = null\n        if (selfDB) {\n            const plantilla = []\n            console.log(\"carga inicial trabajadores\")\n            selfDB.orderBy(\"nombre\").onSnapshot((snap) => {\n                snap.forEach((t) => {\n                    console.log(t.data())\n                    plantilla.push({ id: t.id, ...t.data() })\n                })\n                setTrabajadores(plantilla)\n                console.log(plantilla)\n            })\n\n        }\n\n        return unsubscribe ? () => unsubscribe() : null\n    }, [selfDB, setTrabajadores])\n\n    const createTrabajador = (data) => {\n        /*\n        selfDB.add(data).then((query) => {\n            console.log(\"lo subii\")\n        })\n        */\n        registerUserInLocal(data)\n    }\n\n    const value = {\n        trabajadores,\n        createTrabajador,\n\n    }\n\n\n    return (\n        <TrabajadorContext.Provider value={value}>\n            <ContratoContext.Provider>\n                {children}\n            </ContratoContext.Provider>\n        </TrabajadorContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}